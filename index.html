<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>CIBRA: Computational Identification of Biologically Relevant Alterations • CIBRA</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="CIBRA: Computational Identification of Biologically Relevant Alterations">
<meta name="description" content="CIBRA is a computational method that determines the system-wide impact of genomic alterations by integrating genomics with transcriptomics data.">
<meta property="og:description" content="CIBRA is a computational method that determines the system-wide impact of genomic alterations by integrating genomics with transcriptomics data.">
<meta property="og:image" content="https://ait4life-uu.github.io/CIBRA/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">CIBRA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/alteration_type_refinement.html">Refining alterations on mutation type</a></li>
    <li><a class="dropdown-item" href="articles/genome_wide_screen.html">Genome wide screen using CIBRA</a></li>
    <li><a class="dropdown-item" href="articles/genomic_location_refinement.html">Refining alterations on genomic location</a></li>
    <li><a class="dropdown-item" href="articles/impact_assessment_genomic_alteration.html">CIBRA impact score for a genomic alteration</a></li>
    <li><a class="dropdown-item" href="articles/reference_permutation_distribution.html">reference permutation distribution</a></li>
    <li><a class="dropdown-item" href="articles/similarity_assessment.html">CIBRA similarity score</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="cibra-">CIBRA <a class="anchor" aria-label="anchor" href="#cibra-"></a>
</h1>
</div>
<!-- badges: start -->

<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of CIBRA from <a href="https://github.com/AIT4LIFE-UU/CIBRA" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"AIT4LIFE-UU/CIBRA"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>For extensive examples of the utility of CIBRA, please consult the <a href="https://ait4life-uu.github.io/CIBRA/">vignettes</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load functions</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ait4life-uu.github.io/CIBRA/">CIBRA</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load transcription data and genomic alterations from TCGA COADREAD</span></span>
<span><span class="va">count_data</span> <span class="op">&lt;-</span> <span class="fu">CIBRA</span><span class="fu">::</span><span class="va">TCGA_CRC_rna_data</span></span>
<span><span class="va">mutation_profile</span> <span class="op">&lt;-</span> <span class="fu">CIBRA</span><span class="fu">::</span><span class="va">TCGA_CRC_non_silent_mutation_profile</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prepare-a-definition-matrix-for-analysis-which-indicates-which-samples-are-cases-and-controls">Prepare a definition matrix for analysis which indicates which samples are cases and controls.<a class="anchor" aria-label="anchor" href="#prepare-a-definition-matrix-for-analysis-which-indicates-which-samples-are-cases-and-controls"></a>
</h2>
<p>In this example we will only focus on 6 genes: the tumor suppressor genes APC and TP53, the oncogenes KRAS, BRAF and PIK3CA and the often mutated gene TTN in colorectal cancer.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prepare data for CIBRA</span></span>
<span></span>
<span><span class="co"># select genes of interest</span></span>
<span><span class="va">goi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"APC"</span>, <span class="st">"TP53"</span>, <span class="st">"KRAS"</span>, <span class="st">"BRAF"</span>, <span class="st">"PIK3CA"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># filter mutation profile for only selected genes</span></span>
<span><span class="va">definition_matrix</span> <span class="op">&lt;-</span> <span class="va">mutation_profile</span><span class="op">[</span><span class="va">goi</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># fix sample names for intersect between the two datatypes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">definition_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace_all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">definition_matrix</span><span class="op">)</span>, <span class="st">"-"</span>, <span class="st">"."</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select intersect between definition matrix and count data</span></span>
<span><span class="va">sample_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">definition_matrix</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">count_data</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select data and definition matrix as the intersect</span></span>
<span><span class="va">count_data</span> <span class="op">&lt;-</span> <span class="va">count_data</span><span class="op">[</span><span class="va">sample_list</span><span class="op">]</span></span>
<span><span class="va">definition_matrix</span> <span class="op">&lt;-</span> <span class="va">definition_matrix</span><span class="op">[</span><span class="va">sample_list</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># show definition matrix</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">definition_matrix</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">APC</th>
<th align="left">TP53</th>
<th align="left">KRAS</th>
<th align="left">BRAF</th>
<th align="left">PIK3CA</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">TCGA.3L.AA1B.01A</td>
<td align="left">SNV</td>
<td align="left">WT</td>
<td align="left">WT</td>
<td align="left">SNV</td>
<td align="left">SNV</td>
</tr>
<tr class="even">
<td align="left">TCGA.4N.A93T.01A</td>
<td align="left">WT</td>
<td align="left">SNV</td>
<td align="left">SNV</td>
<td align="left">WT</td>
<td align="left">WT</td>
</tr>
<tr class="odd">
<td align="left">TCGA.4T.AA8H.01A</td>
<td align="left">SNV</td>
<td align="left">WT</td>
<td align="left">SNV</td>
<td align="left">WT</td>
<td align="left">WT</td>
</tr>
<tr class="even">
<td align="left">TCGA.5M.AAT4.01A</td>
<td align="left">SNV</td>
<td align="left">SNV</td>
<td align="left">SNV</td>
<td align="left">WT</td>
<td align="left">WT</td>
</tr>
<tr class="odd">
<td align="left">TCGA.5M.AAT5.01A</td>
<td align="left">SNV</td>
<td align="left">SNV</td>
<td align="left">WT</td>
<td align="left">WT</td>
<td align="left">WT</td>
</tr>
<tr class="even">
<td align="left">TCGA.5M.AAT6.01A</td>
<td align="left">SNV</td>
<td align="left">WT</td>
<td align="left">SNV</td>
<td align="left">WT</td>
<td align="left">WT</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="set-the-parameters-to-use-with-cibra-and-run-cibra">Set the parameters to use with CIBRA and run CIBRA.<a class="anchor" aria-label="anchor" href="#set-the-parameters-to-use-with-cibra-and-run-cibra"></a>
</h2>
<p>You can provide a larger definition matrix and indicate which columns to test in CIBRA. The number of permutation iterations to perform is recommended to be 50 to give an indication of the intrinsic variation in the dataset given the size of cases and control. However to make the example run quicker we have set it to 0 which turns of the internal permutation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># focus on APC</span></span>
<span><span class="va">columns</span> <span class="op">&lt;-</span> <span class="va">goi</span></span>
<span></span>
<span><span class="co"># set up parameters for CIBRA</span></span>
<span><span class="va">control_definition</span> <span class="op">&lt;-</span> <span class="st">"WT"</span> <span class="co"># reference condition</span></span>
<span><span class="va">confidence</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co"># confidence threshold for the proportion calculation</span></span>
<span><span class="co"># set permutation to 0 to skip permutations</span></span>
<span><span class="va">iterations</span> <span class="op">=</span> <span class="fl">0</span> <span class="co"># number of permutation iterations to be performed per condition</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SnowParam-class.html" class="external-link">SnowParam</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="co"># set number of cores to be used</span></span>
<span></span>
<span><span class="co"># run CIBRA with default DE analysis method (DESeq2)</span></span>
<span><span class="va">CIBRA_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_CIBRA.html">run_CIBRA</a></span><span class="op">(</span><span class="va">count_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">definition_matrix</span><span class="op">)</span>, </span>
<span>                       columns <span class="op">=</span> <span class="va">columns</span>, </span>
<span>                       control_definition <span class="op">=</span> <span class="va">control_definition</span>, </span>
<span>                       confidence <span class="op">=</span> <span class="va">confidence</span>, </span>
<span>                       iterations <span class="op">=</span> <span class="va">iterations</span>, </span>
<span>                       parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "SNV"</span></span>
<span><span class="co">#&gt; [1] "APC" "SNV"</span></span>
<span><span class="co">#&gt; [1] "SNV"</span></span>
<span><span class="co">#&gt; [1] "TP53" "SNV" </span></span>
<span><span class="co">#&gt; [1] "SNV"</span></span>
<span><span class="co">#&gt; [1] "KRAS" "SNV" </span></span>
<span><span class="co">#&gt; [1] "SNV"</span></span>
<span><span class="co">#&gt; [1] "BRAF" "SNV" </span></span>
<span><span class="co">#&gt; [1] "SNV"</span></span>
<span><span class="co">#&gt; [1] "PIK3CA" "SNV"</span></span></code></pre></div>
<p>If the iterations where not set to 0, the average permutation signal measures and the standard deviation would have been reported.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print the report table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">CIBRA_res</span><span class="op">$</span><span class="va">CIBRA_results</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="3%">
<col width="5%">
<col width="8%">
<col width="7%">
<col width="9%">
<col width="6%">
<col width="13%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">def</th>
<th align="left">col</th>
<th align="left">proportion</th>
<th align="left">sign_area</th>
<th align="left">investigated</th>
<th align="left">control</th>
<th align="left">proportion_rnd_avg</th>
<th align="left">proportion_rnd_sd</th>
<th align="left">sign_area_rnd_avg</th>
<th align="left">sign_area_rnd_sd</th>
<th align="left">iterations</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SNV</td>
<td align="left">APC</td>
<td align="left">0.4165</td>
<td align="left">0.4228</td>
<td align="left">358</td>
<td align="left">113</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">SNV</td>
<td align="left">TP53</td>
<td align="left">0.429</td>
<td align="left">0.4348</td>
<td align="left">276</td>
<td align="left">195</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">SNV</td>
<td align="left">KRAS</td>
<td align="left">0.3291</td>
<td align="left">0.3297</td>
<td align="left">198</td>
<td align="left">273</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">SNV</td>
<td align="left">BRAF</td>
<td align="left">0.4552</td>
<td align="left">0.4418</td>
<td align="left">66</td>
<td align="left">405</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">SNV</td>
<td align="left">PIK3CA</td>
<td align="left">0.2841</td>
<td align="left">0.2716</td>
<td align="left">131</td>
<td align="left">340</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="assess-significance-of-the-signal-measures">Assess significance of the signal measures<a class="anchor" aria-label="anchor" href="#assess-significance-of-the-signal-measures"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the pvalue by comparing to a reference distribution generated with DESeq2</span></span>
<span><span class="va">perm_data</span> <span class="op">&lt;-</span> <span class="fu">CIBRA</span><span class="fu">::</span><span class="va">perm_dist_crc_tcga</span></span>
<span></span>
<span><span class="co"># use the gamma test to also calculate a fitted p-value</span></span>
<span><span class="va">CIBRA_res_stat</span> <span class="op">&lt;-</span>  <span class="fu"><a href="reference/permutation_test.html">permutation_test</a></span><span class="op">(</span><span class="va">CIBRA_res</span><span class="op">$</span><span class="va">CIBRA_results</span>, <span class="va">perm_data</span>, test <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print the report table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">CIBRA_res_stat</span><span class="op">$</span><span class="va">results</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="2%">
<col width="3%">
<col width="5%">
<col width="5%">
<col width="6%">
<col width="4%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="8%">
<col width="5%">
<col width="7%">
<col width="7%">
<col width="6%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">def</th>
<th align="left">col</th>
<th align="left">proportion</th>
<th align="left">sign_area</th>
<th align="left">investigated</th>
<th align="left">control</th>
<th align="left">proportion_rnd_avg</th>
<th align="left">proportion_rnd_sd</th>
<th align="left">sign_area_rnd_avg</th>
<th align="left">sign_area_rnd_sd</th>
<th align="left">iterations</th>
<th align="right">perm_test_prop</th>
<th align="right">perm_test_area</th>
<th align="right">pvalue_prop</th>
<th align="right">pvalue_sign_area</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SNV</td>
<td align="left">APC</td>
<td align="left">0.4165</td>
<td align="left">0.4228</td>
<td align="left">358</td>
<td align="left">113</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">0</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000172</td>
<td align="right">0.0009079</td>
</tr>
<tr class="even">
<td align="left">SNV</td>
<td align="left">TP53</td>
<td align="left">0.429</td>
<td align="left">0.4348</td>
<td align="left">276</td>
<td align="left">195</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">0</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000089</td>
<td align="right">0.0007003</td>
</tr>
<tr class="odd">
<td align="left">SNV</td>
<td align="left">KRAS</td>
<td align="left">0.3291</td>
<td align="left">0.3297</td>
<td align="left">198</td>
<td align="left">273</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">0</td>
<td align="right">0.0052910</td>
<td align="right">0.0070547</td>
<td align="right">0.0012682</td>
<td align="right">0.0065272</td>
</tr>
<tr class="even">
<td align="left">SNV</td>
<td align="left">BRAF</td>
<td align="left">0.4552</td>
<td align="left">0.4418</td>
<td align="left">66</td>
<td align="left">405</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">0</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000022</td>
<td align="right">0.0006016</td>
</tr>
<tr class="odd">
<td align="left">SNV</td>
<td align="left">PIK3CA</td>
<td align="left">0.2841</td>
<td align="left">0.2716</td>
<td align="left">131</td>
<td align="left">340</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">0</td>
<td align="right">0.0176367</td>
<td align="right">0.0291005</td>
<td align="right">0.0089891</td>
<td align="right">0.0212896</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="visualize-the-results">visualize the results<a class="anchor" aria-label="anchor" href="#visualize-the-results"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualize the results</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="va">CIBRA_res_stat</span><span class="op">$</span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">col</span>, <span class="va">investigated</span>, <span class="va">control</span>, <span class="va">sign_area</span>, </span>
<span>                                 <span class="va">pvalue_sign_area</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sign_area</span><span class="op">)</span>, </span>
<span>                          x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">pvalue_sign_area</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">investigated</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">investigated</span><span class="op">)</span> </span>
<span>                                                  <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">control</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span>, </span>
<span>             shape <span class="op">=</span> <span class="fl">21</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"black"</span>, stroke <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"CIBRA impact score (Significant Area)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_fill_continuous</a></span><span class="op">(</span><span class="st">'p-value'</span>, low <span class="op">=</span> <span class="st">"#ffffcc"</span>, high <span class="op">=</span> <span class="st">"#800026"</span>, </span>
<span>                        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                        trans <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/transform_compose.html" class="external-link">compose_trans</a></span><span class="op">(</span><span class="st">"log10"</span>, <span class="st">"reverse"</span><span class="op">)</span>,</span>
<span>                        limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.00001</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size_area</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Cases (%)"</span>, </span>
<span>                  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">75</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>                  limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span>, max_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span>, override.aes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkgrey"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-visualize-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<p>For questions, suggestions, or bug reports, please send an e-mail to Soufyan Lakbir (<a href="mailto:s.lakbir@vu.nl" class="email">s.lakbir@vu.nl</a>).</p>
<p>if you use <a href="ait4life-uu.github.io/CIBRA/">CIBRA</a> in published research, please cite: Lakbir S, et al. CIBRA identifies genomic alterations with a system-wide impact on tumor biology. Bioinformatics. 2024 Sep 1;40(Suppl 2):ii37-ii44. doi: 10.1093/bioinformatics/btae384. PMID: 39230704; PMCID: PMC11373315.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>AGPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing CIBRA</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Soufyan Lakbir <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-8521-4408" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/nayfous/CIBRA/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/nayfous/CIBRA/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Soufyan Lakbir.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
