<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Refining alterations on mutation type â€¢ CIBRA</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Refining alterations on mutation type">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CIBRA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/alteration_type_refinement.html">Refining alterations on mutation type</a></li>
    <li><a class="dropdown-item" href="../articles/genome_wide_screen.html">Genome wide screen using CIBRA</a></li>
    <li><a class="dropdown-item" href="../articles/genomic_location_refinement.html">Refining alterations on genomic location</a></li>
    <li><a class="dropdown-item" href="../articles/impact_assessment_genomic_alteration.html">CIBRA impact score for a genomic alteration</a></li>
    <li><a class="dropdown-item" href="../articles/reference_permutation_distribution.html">reference permutation distribution</a></li>
    <li><a class="dropdown-item" href="../articles/similarity_assessment.html">CIBRA similarity score</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Refining alterations on mutation type</h1>
            
      

      <div class="d-none name"><code>alteration_type_refinement.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we will use CIBRA to identify the most impactfull
mutation type. We will make use of WES data and RNA-seq data from the
TCGA, specifically from colorectal cancer.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ait4life-uu.github.io/CIBRA/">CIBRA</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load data</span></span>
<span><span class="va">count_data</span> <span class="op">&lt;-</span> <span class="fu">CIBRA</span><span class="fu">::</span><span class="va">TCGA_CRC_rna_data</span> <span class="co"># rna count data</span></span>
<span></span>
<span><span class="co"># genomic alteration profile</span></span>
<span><span class="va">genomic_metrics</span> <span class="op">&lt;-</span> <span class="fu">CIBRA</span><span class="fu">::</span><span class="va">genomic_alteration_profile</span></span>
<span></span>
<span><span class="co"># remove letter to match sample names of genomic metrics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">count_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html" class="external-link">str_sub</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">count_data</span><span class="op">)</span>, end <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>For the refinement on mutation type, we create a definition matrix
with the mutation types we want to assess compared to the reference
condition. In this example, we are exploring SNV and SCNAs and their
combination.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># process the genomic alteration profile for the definition matrix</span></span>
<span></span>
<span><span class="co"># select genes of interest</span></span>
<span><span class="va">goi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"APC"</span>, <span class="st">"TP53"</span>, <span class="st">"KRAS"</span>, <span class="st">"BRAF"</span>, <span class="st">"PIK3CA"</span>, <span class="st">"TTN"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">definition_matrix</span> <span class="op">&lt;-</span> <span class="va">genomic_metrics</span><span class="op">[</span><span class="va">goi</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">definition_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace_all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">definition_matrix</span><span class="op">)</span>, <span class="st">"-"</span>, <span class="st">"."</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># process the alteration definition</span></span>
<span><span class="va">mutate_definition</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">x</span>, patter <span class="op">=</span> <span class="st">"([gain|loss|break])|(^wt$)"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"snv"</span>, <span class="co"># SNV only</span></span>
<span>    <span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">x</span>, pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mut|(^wt$)"</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="st">"scna"</span>, <span class="co"># SCNA only</span></span>
<span>    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">x</span>, pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(mut;[gain|loss])"</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="st">"snv_scna"</span>, <span class="co"># the combination</span></span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"wt"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">definition_matrix</span> <span class="op">&lt;-</span> <span class="va">definition_matrix</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_all</a></span><span class="op">(</span></span>
<span>  <span class="va">mutate_definition</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># match data between definition matrix and the count data</span></span>
<span><span class="va">sample_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">definition_matrix</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">count_data</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">count_data</span><span class="op">[</span><span class="va">sample_list</span><span class="op">]</span></span>
<span><span class="va">definition_matrix</span> <span class="op">&lt;-</span> <span class="va">definition_matrix</span><span class="op">[</span><span class="va">sample_list</span>,<span class="op">]</span></span></code></pre></div>
<p>Now that we have created the definition matrix and prepared the RNA
count data, we can run CIBRA. We can select a subset of columns we want
to asssess. CIBRA automatically assesses all definitions within the
column against the control_definition provided.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># focus on the genes of interest</span></span>
<span><span class="va">columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TP53"</span>, <span class="st">"APC"</span>, <span class="st">"KRAS"</span>, <span class="st">"BRAF"</span>, <span class="st">"PIK3CA"</span>, <span class="st">"TTN"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set up parameters for CIBRA</span></span>
<span><span class="va">control_definition</span> <span class="op">&lt;-</span> <span class="st">"wt"</span> <span class="co"># reference condition</span></span>
<span><span class="va">confidence</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co"># confidence threshold for the proportion calculation</span></span>
<span><span class="co"># set permutation to 0 to skip permutations</span></span>
<span><span class="va">iterations</span> <span class="op">=</span> <span class="fl">0</span> <span class="co"># number of permutation iterations to be performed per condition</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SnowParam-class.html" class="external-link">SnowParam</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="co"># set number of cores to be used</span></span>
<span></span>
<span><span class="co"># run CIBRA</span></span>
<span><span class="va">CIBRA_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_CIBRA.html">run_CIBRA</a></span><span class="op">(</span><span class="va">count_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">definition_matrix</span><span class="op">)</span>, <span class="va">columns</span>, </span>
<span>                       <span class="va">control_definition</span>, <span class="va">confidence</span>, <span class="va">iterations</span>, </span>
<span>                       parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "snv_scna" "scna"     "snv"     </span></span>
<span><span class="co">#&gt; [1] "TP53"     "snv_scna"</span></span>
<span><span class="co">#&gt; [1] "TP53" "scna"</span></span>
<span><span class="co">#&gt; [1] "TP53" "snv"</span></span>
<span><span class="co">#&gt; [1] "snv"      "snv_scna" "scna"    </span></span>
<span><span class="co">#&gt; [1] "APC" "snv"</span></span>
<span><span class="co">#&gt; [1] "APC"      "snv_scna"</span></span>
<span><span class="co">#&gt; [1] "APC"  "scna"</span></span>
<span><span class="co">#&gt; [1] "snv"      "snv_scna" "scna"    </span></span>
<span><span class="co">#&gt; [1] "KRAS" "snv"</span></span>
<span><span class="co">#&gt; [1] "KRAS"     "snv_scna"</span></span>
<span><span class="co">#&gt; [1] "KRAS" "scna"</span></span>
<span><span class="co">#&gt; [1] "scna"     "snv_scna" "snv"     </span></span>
<span><span class="co">#&gt; [1] "BRAF" "scna"</span></span>
<span><span class="co">#&gt; [1] "BRAF"     "snv_scna"</span></span>
<span><span class="co">#&gt; [1] "BRAF" "snv"</span></span>
<span><span class="co">#&gt; [1] "scna"     "snv"      "snv_scna"</span></span>
<span><span class="co">#&gt; [1] "PIK3CA" "scna"</span></span>
<span><span class="co">#&gt; [1] "PIK3CA" "snv"</span></span>
<span><span class="co">#&gt; [1] "PIK3CA"   "snv_scna"</span></span>
<span><span class="co">#&gt; [1] "snv_scna" "snv"      "scna"    </span></span>
<span><span class="co">#&gt; [1] "TTN"      "snv_scna"</span></span>
<span><span class="co">#&gt; [1] "TTN" "snv"</span></span>
<span><span class="co">#&gt; [1] "TTN"  "scna"</span></span></code></pre></div>
<p>From the results below, it can be observed that the most impactful
definition is different for each gene and depends on what type of gene
it is. For example for the tumor suppressor genes TP53 and APC, the
combination of SNV and SCNA results in the highest impact score. While
for the oncogene BRAF, only SNVs give the highest score.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print the report table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">CIBRA_res</span><span class="op">$</span><span class="va">CIBRA_results</span>, format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
def
</th>
<th style="text-align:left;">
col
</th>
<th style="text-align:left;">
proportion
</th>
<th style="text-align:left;">
sign_area
</th>
<th style="text-align:left;">
investigated
</th>
<th style="text-align:left;">
control
</th>
<th style="text-align:left;">
proportion_rnd_avg
</th>
<th style="text-align:left;">
proportion_rnd_sd
</th>
<th style="text-align:left;">
sign_area_rnd_avg
</th>
<th style="text-align:left;">
sign_area_rnd_sd
</th>
<th style="text-align:left;">
iterations
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
snv_scna
</td>
<td style="text-align:left;">
TP53
</td>
<td style="text-align:left;">
0.4786
</td>
<td style="text-align:left;">
0.4674
</td>
<td style="text-align:left;">
217
</td>
<td style="text-align:left;">
129
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
scna
</td>
<td style="text-align:left;">
TP53
</td>
<td style="text-align:left;">
0.3464
</td>
<td style="text-align:left;">
0.3409
</td>
<td style="text-align:left;">
66
</td>
<td style="text-align:left;">
129
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
snv
</td>
<td style="text-align:left;">
TP53
</td>
<td style="text-align:left;">
0.2713
</td>
<td style="text-align:left;">
0.2716
</td>
<td style="text-align:left;">
59
</td>
<td style="text-align:left;">
129
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
snv
</td>
<td style="text-align:left;">
APC
</td>
<td style="text-align:left;">
0.371
</td>
<td style="text-align:left;">
0.3721
</td>
<td style="text-align:left;">
216
</td>
<td style="text-align:left;">
81
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
snv_scna
</td>
<td style="text-align:left;">
APC
</td>
<td style="text-align:left;">
0.4375
</td>
<td style="text-align:left;">
0.4414
</td>
<td style="text-align:left;">
142
</td>
<td style="text-align:left;">
81
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
scna
</td>
<td style="text-align:left;">
APC
</td>
<td style="text-align:left;">
0.3405
</td>
<td style="text-align:left;">
0.4069
</td>
<td style="text-align:left;">
32
</td>
<td style="text-align:left;">
81
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
snv
</td>
<td style="text-align:left;">
KRAS
</td>
<td style="text-align:left;">
0.2848
</td>
<td style="text-align:left;">
0.2793
</td>
<td style="text-align:left;">
122
</td>
<td style="text-align:left;">
186
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
snv_scna
</td>
<td style="text-align:left;">
KRAS
</td>
<td style="text-align:left;">
0.2494
</td>
<td style="text-align:left;">
0.2252
</td>
<td style="text-align:left;">
76
</td>
<td style="text-align:left;">
186
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
scna
</td>
<td style="text-align:left;">
KRAS
</td>
<td style="text-align:left;">
0.1714
</td>
<td style="text-align:left;">
0.1093
</td>
<td style="text-align:left;">
87
</td>
<td style="text-align:left;">
186
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
scna
</td>
<td style="text-align:left;">
BRAF
</td>
<td style="text-align:left;">
0.3081
</td>
<td style="text-align:left;">
0.2862
</td>
<td style="text-align:left;">
224
</td>
<td style="text-align:left;">
181
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
snv_scna
</td>
<td style="text-align:left;">
BRAF
</td>
<td style="text-align:left;">
0.2303
</td>
<td style="text-align:left;">
0.2086
</td>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
181
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
snv
</td>
<td style="text-align:left;">
BRAF
</td>
<td style="text-align:left;">
0.4169
</td>
<td style="text-align:left;">
0.4125
</td>
<td style="text-align:left;">
52
</td>
<td style="text-align:left;">
181
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
scna
</td>
<td style="text-align:left;">
PIK3CA
</td>
<td style="text-align:left;">
0.203
</td>
<td style="text-align:left;">
0.1616
</td>
<td style="text-align:left;">
98
</td>
<td style="text-align:left;">
242
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
snv
</td>
<td style="text-align:left;">
PIK3CA
</td>
<td style="text-align:left;">
0.2256
</td>
<td style="text-align:left;">
0.185
</td>
<td style="text-align:left;">
108
</td>
<td style="text-align:left;">
242
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
snv_scna
</td>
<td style="text-align:left;">
PIK3CA
</td>
<td style="text-align:left;">
0.1824
</td>
<td style="text-align:left;">
0.1292
</td>
<td style="text-align:left;">
23
</td>
<td style="text-align:left;">
242
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
snv_scna
</td>
<td style="text-align:left;">
TTN
</td>
<td style="text-align:left;">
0.1504
</td>
<td style="text-align:left;">
0.1601
</td>
<td style="text-align:left;">
58
</td>
<td style="text-align:left;">
143
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
snv
</td>
<td style="text-align:left;">
TTN
</td>
<td style="text-align:left;">
0.2891
</td>
<td style="text-align:left;">
0.2868
</td>
<td style="text-align:left;">
219
</td>
<td style="text-align:left;">
143
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
scna
</td>
<td style="text-align:left;">
TTN
</td>
<td style="text-align:left;">
0.2114
</td>
<td style="text-align:left;">
0.1831
</td>
<td style="text-align:left;">
51
</td>
<td style="text-align:left;">
143
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
</tr>
</tbody>
</table>
<p>To also assess the significance of the score, we can perform the
gamma inferred permutation test.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the pvalue by comparing to a reference distribution</span></span>
<span><span class="va">perm_data</span> <span class="op">&lt;-</span> <span class="fu">CIBRA</span><span class="fu">::</span><span class="va">perm_dist_crc_tcga</span></span>
<span></span>
<span><span class="co"># use the gamma test to also calculate a fitted p-value</span></span>
<span><span class="va">CIBRA_res_stat</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/permutation_test.html">permutation_test</a></span><span class="op">(</span><span class="va">CIBRA_res</span><span class="op">$</span><span class="va">CIBRA_results</span>, <span class="va">perm_data</span>, test <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print the report table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">CIBRA_res_stat</span><span class="op">$</span><span class="va">results</span>, format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
def
</th>
<th style="text-align:left;">
col
</th>
<th style="text-align:left;">
proportion
</th>
<th style="text-align:left;">
sign_area
</th>
<th style="text-align:left;">
investigated
</th>
<th style="text-align:left;">
control
</th>
<th style="text-align:left;">
proportion_rnd_avg
</th>
<th style="text-align:left;">
proportion_rnd_sd
</th>
<th style="text-align:left;">
sign_area_rnd_avg
</th>
<th style="text-align:left;">
sign_area_rnd_sd
</th>
<th style="text-align:left;">
iterations
</th>
<th style="text-align:right;">
perm_test_prop
</th>
<th style="text-align:right;">
perm_test_area
</th>
<th style="text-align:right;">
pvalue_prop
</th>
<th style="text-align:right;">
pvalue_sign_area
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
snv_scna
</td>
<td style="text-align:left;">
TP53
</td>
<td style="text-align:left;">
0.4786
</td>
<td style="text-align:left;">
0.4674
</td>
<td style="text-align:left;">
217
</td>
<td style="text-align:left;">
129
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000006
</td>
<td style="text-align:right;">
0.0003451
</td>
</tr>
<tr>
<td style="text-align:left;">
scna
</td>
<td style="text-align:left;">
TP53
</td>
<td style="text-align:left;">
0.3464
</td>
<td style="text-align:left;">
0.3409
</td>
<td style="text-align:left;">
66
</td>
<td style="text-align:left;">
129
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.0017637
</td>
<td style="text-align:right;">
0.0044092
</td>
<td style="text-align:right;">
0.0005711
</td>
<td style="text-align:right;">
0.0051794
</td>
</tr>
<tr>
<td style="text-align:left;">
snv
</td>
<td style="text-align:left;">
TP53
</td>
<td style="text-align:left;">
0.2713
</td>
<td style="text-align:left;">
0.2716
</td>
<td style="text-align:left;">
59
</td>
<td style="text-align:left;">
129
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.0299824
</td>
<td style="text-align:right;">
0.0291005
</td>
<td style="text-align:right;">
0.0151134
</td>
<td style="text-align:right;">
0.0213133
</td>
</tr>
<tr>
<td style="text-align:left;">
snv
</td>
<td style="text-align:left;">
APC
</td>
<td style="text-align:left;">
0.371
</td>
<td style="text-align:left;">
0.3721
</td>
<td style="text-align:left;">
216
</td>
<td style="text-align:left;">
81
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0017637
</td>
<td style="text-align:right;">
0.0001745
</td>
<td style="text-align:right;">
0.0026894
</td>
</tr>
<tr>
<td style="text-align:left;">
snv_scna
</td>
<td style="text-align:left;">
APC
</td>
<td style="text-align:left;">
0.4375
</td>
<td style="text-align:left;">
0.4414
</td>
<td style="text-align:left;">
142
</td>
<td style="text-align:left;">
81
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000057
</td>
<td style="text-align:right;">
0.0006082
</td>
</tr>
<tr>
<td style="text-align:left;">
scna
</td>
<td style="text-align:left;">
APC
</td>
<td style="text-align:left;">
0.3405
</td>
<td style="text-align:left;">
0.4069
</td>
<td style="text-align:left;">
32
</td>
<td style="text-align:left;">
81
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.0035273
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0007534
</td>
<td style="text-align:right;">
0.0012810
</td>
</tr>
<tr>
<td style="text-align:left;">
snv
</td>
<td style="text-align:left;">
KRAS
</td>
<td style="text-align:left;">
0.2848
</td>
<td style="text-align:left;">
0.2793
</td>
<td style="text-align:left;">
122
</td>
<td style="text-align:left;">
186
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.0176367
</td>
<td style="text-align:right;">
0.0238095
</td>
<td style="text-align:right;">
0.0087699
</td>
<td style="text-align:right;">
0.0182735
</td>
</tr>
<tr>
<td style="text-align:left;">
snv_scna
</td>
<td style="text-align:left;">
KRAS
</td>
<td style="text-align:left;">
0.2494
</td>
<td style="text-align:left;">
0.2252
</td>
<td style="text-align:left;">
76
</td>
<td style="text-align:left;">
186
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.0476190
</td>
<td style="text-align:right;">
0.0582011
</td>
<td style="text-align:right;">
0.0347619
</td>
<td style="text-align:right;">
0.0526923
</td>
</tr>
<tr>
<td style="text-align:left;">
scna
</td>
<td style="text-align:left;">
KRAS
</td>
<td style="text-align:left;">
0.1714
</td>
<td style="text-align:left;">
0.1093
</td>
<td style="text-align:left;">
87
</td>
<td style="text-align:left;">
186
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.3236332
</td>
<td style="text-align:right;">
0.3209877
</td>
<td style="text-align:right;">
0.3567770
</td>
<td style="text-align:right;">
0.3887167
</td>
</tr>
<tr>
<td style="text-align:left;">
scna
</td>
<td style="text-align:left;">
BRAF
</td>
<td style="text-align:left;">
0.3081
</td>
<td style="text-align:left;">
0.2862
</td>
<td style="text-align:left;">
224
</td>
<td style="text-align:left;">
181
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.0088183
</td>
<td style="text-align:right;">
0.0220459
</td>
<td style="text-align:right;">
0.0032632
</td>
<td style="text-align:right;">
0.0159074
</td>
</tr>
<tr>
<td style="text-align:left;">
snv_scna
</td>
<td style="text-align:left;">
BRAF
</td>
<td style="text-align:left;">
0.2303
</td>
<td style="text-align:left;">
0.2086
</td>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
181
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.0776014
</td>
<td style="text-align:right;">
0.0679012
</td>
<td style="text-align:right;">
0.0679381
</td>
<td style="text-align:right;">
0.0720578
</td>
</tr>
<tr>
<td style="text-align:left;">
snv
</td>
<td style="text-align:left;">
BRAF
</td>
<td style="text-align:left;">
0.4169
</td>
<td style="text-align:left;">
0.4125
</td>
<td style="text-align:left;">
52
</td>
<td style="text-align:left;">
181
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0000170
</td>
<td style="text-align:right;">
0.0011358
</td>
</tr>
<tr>
<td style="text-align:left;">
scna
</td>
<td style="text-align:left;">
PIK3CA
</td>
<td style="text-align:left;">
0.203
</td>
<td style="text-align:left;">
0.1616
</td>
<td style="text-align:left;">
98
</td>
<td style="text-align:left;">
242
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.1613757
</td>
<td style="text-align:right;">
0.1569665
</td>
<td style="text-align:right;">
0.1593826
</td>
<td style="text-align:right;">
0.1678161
</td>
</tr>
<tr>
<td style="text-align:left;">
snv
</td>
<td style="text-align:left;">
PIK3CA
</td>
<td style="text-align:left;">
0.2256
</td>
<td style="text-align:left;">
0.185
</td>
<td style="text-align:left;">
108
</td>
<td style="text-align:left;">
242
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.0908289
</td>
<td style="text-align:right;">
0.1075838
</td>
<td style="text-align:right;">
0.0794117
</td>
<td style="text-align:right;">
0.1110906
</td>
</tr>
<tr>
<td style="text-align:left;">
snv_scna
</td>
<td style="text-align:left;">
PIK3CA
</td>
<td style="text-align:left;">
0.1824
</td>
<td style="text-align:left;">
0.1292
</td>
<td style="text-align:left;">
23
</td>
<td style="text-align:left;">
242
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.2513228
</td>
<td style="text-align:right;">
0.2548501
</td>
<td style="text-align:right;">
0.2761134
</td>
<td style="text-align:right;">
0.2869234
</td>
</tr>
<tr>
<td style="text-align:left;">
snv_scna
</td>
<td style="text-align:left;">
TTN
</td>
<td style="text-align:left;">
0.1504
</td>
<td style="text-align:left;">
0.1601
</td>
<td style="text-align:left;">
58
</td>
<td style="text-align:left;">
143
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.5088183
</td>
<td style="text-align:right;">
0.1613757
</td>
<td style="text-align:right;">
0.5379990
</td>
<td style="text-align:right;">
0.1722009
</td>
</tr>
<tr>
<td style="text-align:left;">
snv
</td>
<td style="text-align:left;">
TTN
</td>
<td style="text-align:left;">
0.2891
</td>
<td style="text-align:left;">
0.2868
</td>
<td style="text-align:left;">
219
</td>
<td style="text-align:left;">
143
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.0167549
</td>
<td style="text-align:right;">
0.0220459
</td>
<td style="text-align:right;">
0.0073405
</td>
<td style="text-align:right;">
0.0157162
</td>
</tr>
<tr>
<td style="text-align:left;">
scna
</td>
<td style="text-align:left;">
TTN
</td>
<td style="text-align:left;">
0.2114
</td>
<td style="text-align:left;">
0.1831
</td>
<td style="text-align:left;">
51
</td>
<td style="text-align:left;">
143
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.1305115
</td>
<td style="text-align:right;">
0.1102293
</td>
<td style="text-align:right;">
0.1243580
</td>
<td style="text-align:right;">
0.1149510
</td>
</tr>
</tbody>
</table></main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Soufyan Lakbir.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
