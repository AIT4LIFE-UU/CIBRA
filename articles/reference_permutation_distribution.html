<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>reference permutation distribution • CIBRA</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="reference permutation distribution">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CIBRA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/alteration_type_refinement.html">Refining alterations on mutation type</a></li>
    <li><a class="dropdown-item" href="../articles/genome_wide_screen.html">Genome wide screen using CIBRA</a></li>
    <li><a class="dropdown-item" href="../articles/genomic_location_refinement.html">Refining alterations on genomic location</a></li>
    <li><a class="dropdown-item" href="../articles/impact_assessment_genomic_alteration.html">CIBRA impact score for a genomic alteration</a></li>
    <li><a class="dropdown-item" href="../articles/reference_permutation_distribution.html">reference permutation distribution</a></li>
    <li><a class="dropdown-item" href="../articles/similarity_assessment.html">CIBRA similarity score</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>reference permutation distribution</h1>
            
      

      <div class="d-none name"><code>reference_permutation_distribution.Rmd</code></div>
    </div>

    
    
<p>In this vignette we will explore how to generate a permutation
distribution of the CIBRA impact scores to assess the statistical
significance of the score.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ait4life-uu.github.io/CIBRA/">CIBRA</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span></span></code></pre></div>
<p>For generating a permutation ditribution with CIBRA, we will only
need RNA-seq counts as the definition matrix will be randomly
generaterd.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load transcriptomics data</span></span>
<span><span class="va">count_data</span> <span class="op">&lt;-</span> <span class="fu">CIBRA</span><span class="fu">::</span><span class="va">TCGA_CRC_rna_data</span></span></code></pre></div>
<p>There are a few parameters we have to set to generate the
distribution. One is the number of iterations (permutations) we want to
run. Moreover, we have to design a case and control grid with the number
of cases and control we want to assess. Depending on the use case of the
distribution, we want to as closely mimic the cases we will test. As
such the case and control list can consist of known examples or be a
broad range to have a general distribution. The number of cases/controls
doesn’t have much influence on the scores except if you go below the 10
cases.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set parameters for the reference distribution</span></span>
<span><span class="va">control_definition</span> <span class="op">&lt;-</span> <span class="st">"NO_SNV"</span></span>
<span><span class="va">confidence</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co"># use the same confidence as used in standard analysis</span></span>
<span><span class="va">iterations</span> <span class="op">&lt;-</span> <span class="fl">50</span> <span class="co"># recommended are at least 1000 permutations to explore the full space</span></span>
<span><span class="co"># create lists of different case and control sizes</span></span>
<span><span class="va">case_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">count_data</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># recommended value is at least 20 different case and control values</span></span>
<span><span class="va">control_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">count_data</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SnowParam-class.html" class="external-link">SnowParam</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="co"># set number of cores to be used</span></span>
<span></span>
<span><span class="co"># run permutation screen</span></span>
<span><span class="va">CIBRA_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_permutation_dist.html">generate_permutation_dist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">count_data</span>, case_list <span class="op">=</span> <span class="va">case_list</span>, </span>
<span>                                       control_list <span class="op">=</span> <span class="va">control_list</span>, </span>
<span>                                       control_definition <span class="op">=</span> <span class="va">control_definition</span>, confidence <span class="op">=</span> <span class="va">confidence</span>, </span>
<span>                                       iterations <span class="op">=</span> <span class="va">iterations</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, permutation <span class="op">=</span> <span class="st">"sample"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "testing: 10and 10"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 10, iteration: 1"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 10, iteration: 2"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 10, iteration: 3"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 10, iteration: 4"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 10, iteration: 5"</span></span>
<span><span class="co">#&gt; [1] "Done with cases: 10, controls: 10"</span></span>
<span><span class="co">#&gt; [1] "testing: 146.75and 10"</span></span>
<span><span class="co">#&gt; [1] "cases: 146.75, controls: 10, iteration: 1"</span></span>
<span><span class="co">#&gt; [1] "cases: 146.75, controls: 10, iteration: 2"</span></span>
<span><span class="co">#&gt; [1] "cases: 146.75, controls: 10, iteration: 3"</span></span>
<span><span class="co">#&gt; [1] "cases: 146.75, controls: 10, iteration: 4"</span></span>
<span><span class="co">#&gt; [1] "cases: 146.75, controls: 10, iteration: 5"</span></span>
<span><span class="co">#&gt; [1] "Done with cases: 146.75, controls: 10"</span></span>
<span><span class="co">#&gt; [1] "testing: 283.5and 10"</span></span>
<span><span class="co">#&gt; [1] "cases: 283.5, controls: 10, iteration: 1"</span></span>
<span><span class="co">#&gt; [1] "cases: 283.5, controls: 10, iteration: 2"</span></span>
<span><span class="co">#&gt; [1] "cases: 283.5, controls: 10, iteration: 3"</span></span>
<span><span class="co">#&gt; [1] "cases: 283.5, controls: 10, iteration: 4"</span></span>
<span><span class="co">#&gt; [1] "cases: 283.5, controls: 10, iteration: 5"</span></span>
<span><span class="co">#&gt; [1] "Done with cases: 283.5, controls: 10"</span></span>
<span><span class="co">#&gt; [1] "testing: 420.25and 10"</span></span>
<span><span class="co">#&gt; [1] "cases: 420.25, controls: 10, iteration: 1"</span></span>
<span><span class="co">#&gt; [1] "cases: 420.25, controls: 10, iteration: 2"</span></span>
<span><span class="co">#&gt; [1] "cases: 420.25, controls: 10, iteration: 3"</span></span>
<span><span class="co">#&gt; [1] "cases: 420.25, controls: 10, iteration: 4"</span></span>
<span><span class="co">#&gt; [1] "cases: 420.25, controls: 10, iteration: 5"</span></span>
<span><span class="co">#&gt; [1] "Done with cases: 420.25, controls: 10"</span></span>
<span><span class="co">#&gt; [1] "testing: 10and 146.75"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 146.75, iteration: 1"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 146.75, iteration: 2"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 146.75, iteration: 3"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 146.75, iteration: 4"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 146.75, iteration: 5"</span></span>
<span><span class="co">#&gt; [1] "Done with cases: 10, controls: 146.75"</span></span>
<span><span class="co">#&gt; [1] "testing: 146.75and 146.75"</span></span>
<span><span class="co">#&gt; [1] "cases: 146.75, controls: 146.75, iteration: 1"</span></span>
<span><span class="co">#&gt; [1] "cases: 146.75, controls: 146.75, iteration: 2"</span></span>
<span><span class="co">#&gt; [1] "cases: 146.75, controls: 146.75, iteration: 3"</span></span>
<span><span class="co">#&gt; [1] "cases: 146.75, controls: 146.75, iteration: 4"</span></span>
<span><span class="co">#&gt; [1] "cases: 146.75, controls: 146.75, iteration: 5"</span></span>
<span><span class="co">#&gt; [1] "Done with cases: 146.75, controls: 146.75"</span></span>
<span><span class="co">#&gt; [1] "testing: 283.5and 146.75"</span></span>
<span><span class="co">#&gt; [1] "cases: 283.5, controls: 146.75, iteration: 1"</span></span>
<span><span class="co">#&gt; [1] "cases: 283.5, controls: 146.75, iteration: 2"</span></span>
<span><span class="co">#&gt; [1] "cases: 283.5, controls: 146.75, iteration: 3"</span></span>
<span><span class="co">#&gt; [1] "cases: 283.5, controls: 146.75, iteration: 4"</span></span>
<span><span class="co">#&gt; [1] "cases: 283.5, controls: 146.75, iteration: 5"</span></span>
<span><span class="co">#&gt; [1] "Done with cases: 283.5, controls: 146.75"</span></span>
<span><span class="co">#&gt; [1] "testing: 10and 283.5"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 283.5, iteration: 1"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 283.5, iteration: 2"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 283.5, iteration: 3"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 283.5, iteration: 4"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 283.5, iteration: 5"</span></span>
<span><span class="co">#&gt; [1] "Done with cases: 10, controls: 283.5"</span></span>
<span><span class="co">#&gt; [1] "testing: 146.75and 283.5"</span></span>
<span><span class="co">#&gt; [1] "cases: 146.75, controls: 283.5, iteration: 1"</span></span>
<span><span class="co">#&gt; [1] "cases: 146.75, controls: 283.5, iteration: 2"</span></span>
<span><span class="co">#&gt; [1] "cases: 146.75, controls: 283.5, iteration: 3"</span></span>
<span><span class="co">#&gt; [1] "cases: 146.75, controls: 283.5, iteration: 4"</span></span>
<span><span class="co">#&gt; [1] "cases: 146.75, controls: 283.5, iteration: 5"</span></span>
<span><span class="co">#&gt; [1] "Done with cases: 146.75, controls: 283.5"</span></span>
<span><span class="co">#&gt; [1] "testing: 10and 420.25"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 420.25, iteration: 1"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 420.25, iteration: 2"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 420.25, iteration: 3"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 420.25, iteration: 4"</span></span>
<span><span class="co">#&gt; [1] "cases: 10, controls: 420.25, iteration: 5"</span></span>
<span><span class="co">#&gt; [1] "Done with cases: 10, controls: 420.25"</span></span></code></pre></div>
<p>We can visualize the distribution as shown below. This is however a
limited distribution as we have only performed 50 permutations. For
statistical testing 1000 permutations are recommended.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract the perm data from the results</span></span>
<span><span class="va">perm_data</span> <span class="op">&lt;-</span> <span class="va">CIBRA_res</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># save the permuation data for later testing</span></span>
<span></span>
<span><span class="co"># visualize the proportion</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">perm_data</span><span class="op">$</span><span class="va">proportion</span>, breaks <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference_permutation_distribution_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize the significant area</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">perm_data</span><span class="op">$</span><span class="va">significant_area</span>, breaks <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference_permutation_distribution_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the significant area still contains invalid values</span></span></code></pre></div>
<p>The proportion can indicate if the p-value distribution is invalid.
Here below we will remove the entries with an invalid impact score,
which are those where the proportion is below the threshold (confidence)
we have set.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remove the invalid values which have a proportion below 0.1</span></span>
<span><span class="va">corrected_perm_data</span> <span class="op">&lt;-</span> <span class="va">perm_data</span><span class="op">[</span><span class="va">perm_data</span><span class="op">$</span><span class="va">proportion</span> <span class="op">&gt;=</span> <span class="fl">0.1</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">corrected_perm_data</span><span class="op">$</span><span class="va">proportion</span>, breaks <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference_permutation_distribution_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">corrected_perm_data</span><span class="op">$</span><span class="va">significant_area</span>, breaks<span class="op">=</span><span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference_permutation_distribution_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Soufyan Lakbir.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
